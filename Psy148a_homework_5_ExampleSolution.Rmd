---
title: "Psy148a_homework_5_ExampleSolution"
author: "Ricardo Zaragoza Castillo"
date: "November 12, 2018"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Note: 
This assignment requires 3 documents in your submission:\  

(1) Your Markdown (.Rmd) which is generated as a new file in RStudio by clicking the File --> New File --> R Markdown --> Document menu, then name it and save it;\  

(2) the HTML file based on your .Rmd file, which is generated by the **Knit** button and automatically saved in your directory; and\  

(3) the related R script file (.R), you need to create an R script by clicking File --> New File --> R Script, then name it and save it.\  

#####In the R Script you need to use an **#** before your comments to run your script wihtout problems. Thus, you can base your R script on your R Markdown document but **it is not just a copy and paste**

### Question 1.\  
Please read the question in your assignment, the instructions ask for commenting all your work and acknowledge the help and/or cite the resource appropriately.

### Question 2.\  

* set your working directory to 'Psy148a_F2017';

To set a working directory use the command setwd()

```{r}
###code for question 2.
#The folder of the working directory must be created before using the command setwd()
setwd("C:/Example_wd")
#The working directory will be reset when the chunk is finished running.

# use function ls() to list the contents/objects in your R workspace. The output should be 'character(0)'. 
# If the output is not 'character(0), use function rm() to remove any objects in your R workspace
ls()

```

### Question 3.\  

[total 30 points] Write R codes in the R code chunk below to do the following or answer the question:\  

* Read the dataset 'Adams_1996.csv' into R and store it in an object named 'adams' as a data frame. Here are the variables in the dataset:

```{r}
#This is an example of how to read a .csv file and store it as a data.frame
# <- this symbol assigns the content on the right to the object defined on the left, it can be substituted by "=" (the equal) symbol

# Remember, you would need to substitute this file name, for the one to be used to solve the assignment

example_read <- data.frame(read.csv('Automobile_price_data.csv', header = TRUE))
# it is important to precise if the dataset contains a header with the name of the variables
#View(example_read)
# Remember that all your files must be in your working directory

```

##### Get to know the data by generating the following statistics:

* the number of observations and number of variables in the data

```{r}
#This is a command to know better the dataset we are using, including the number of observations and variables
str(example_read)
# This dataset contains 205 obs. of  26 variables
```

* get the variable names in the dataset and store it in an object named 'my.vars', it should be a
character vector. Print this object.

```{r}
#This is a command to get the variable names in the dataset and store it in an object named 'my.vars
my.vars <- names(example_read)
# Remember "<-" symbol assigns the content on the right to the object defined on the left, it can be substituted by "=" (the equal) symbol
# printing in R Markdown can be just by calling the object
my.vars

```

* check whether any missing values (i.e. values NA) in the data 'adams', this check should return one TRUE or one FALSE, with TRUE indicating that there is/are missing value(s).

```{r}
# This command is an example of how to check the missing values per row and column
is.na(example_read)[1:10,1:10]
# Try storing this result as a dataset and use the command View to check all the cells looking for the missing values

```

* Using function _table() on the variable 'Group' in the data. Notice that this variable has only two values, it should be a categorical variable.

```{r}
# The $ symbol allows to access the variables when use to the right of the data frame name
table(example_read$num.of.doors)

```

* Coerce this variable to be a factor and attach label to each level as following: 1-'placebo', 2-'drug'.

In this dataset the variable num.of.doors is already a factor, nevertheless here there is an example of how to coerce a variable to be a factor and attach a label to each level

```{r}
# Remember that to the left of the <- symbol we assign the values of the right side of the <- symbol
example_read$num.of.doors <- ifelse(example_read$num.of.doors == 'four', 'placebo', 'drug')

```

String values must be quoted with '' or "" to avoid errors. However, if the you have values you need to avoid quotes for instance 1 would produce an error if you type '1' when it is stored as a value. With the command str() you can see how each variable is stored.

```{r}
# In this case we indicated that the value 'four' corresponds to the level placebo, and drug otherwise
example_read$num.of.doors <- factor(example_read$num.of.doors, levels = c('placebo', 'drug'))

```

With the table() command you can see how the levels have changed

```{r}
table(example_read$num.of.doors)

```

Use brackets to limit the number of observations printed

```{r}
example_read$num.of.doors[1:5]

```

- The values of variable 'Arousal' should be non-negative, identify and show the observations in the data 'adams' with 'Arousal' having negative values.

```{r}
# We use the $ symbol to select and print the values of one variable contained in the dataset we are working with
example_read$normalized.losses
# In this case we do not have negative values but you can see that there are ? values
```

- Generate a working dataset named 'working' based upon data 'adams' but keep only those observations whose 'Arousal' has non-negative values and the values should be less than the maximum value of 'Arousal' in the data.

```{r}
# First identify the maximum value of the variable you are working with. To obtain the max, min, etc., the variable must be numeric
summary(example_read$symboling)

```

Now lets generate a working dataset named 'working' based upon data 'example_read' but keep only those observations whose 'symboling' has non-negative values and the values should be less than the maximum value of 'symboling' in the data.

```{r}
#This first subset includes all the collumns and rows for 'symboling' with non-negative values and less than the maximum value
# the comma "," to the right of the indicates that we are working with a dataframe
working <- subset(example_read[example_read$symboling >= 0 & example_read$symboling < 3, ])   
# We print the results to verify that there are not negative values and that the maximum value is less than 3
working$symboling

```

- Generate side-by-side boxplot of 'Arousal' by 'Group', with a main title 'Boxplot of Arousal by Group' and label Y axis as 'Arousal level'. Describe briefly what the boxplots reveal in terms of the relationship between 'Arousal' and the two experimental conditions.

```{r}
# There is a basic boxplot function 
boxplot(symboling~aspiration, data = working,  main ="Boxplot of symboling by aspiration", ylab = "symboling", xlab = "aspiration")

```

Also you can elaborate more advanced graphics with the ggplot package

```{r}
# First install ggplot package
# install.packages(ggplot2)
#Then call the package
library(ggplot2)
ggplot(working, aes(aspiration, symboling)) + 
       geom_boxplot() +
  ggtitle('Boxplot of symboling by aspiration')

```

- Generate a histogram of 'Arousal' with a main title 'Histogram of Arousal', label X axis as 'Arousal level', label Y axis as 'Density', set the values in x axis from 0 to 50, the values in y axis from 0 to .05. 
* Add a normal curve to the histogram

```{r}
#This is an example of how to do your own histogram, you need to change the parameter following the instructions in the assignment
x <- seq(0,40,0.1)
hist(mtcars$mpg, col="blue", main = "Histogram of mpg", xlab = "mpg", ylab = "Density", xlim = range(7:38), ylim = range(0,0.10), freq = FALSE)
# We added a hypothetical normal distribution with a mean of 20 and a sd of 6, which is close to the empirical one but it is not equal
curve(dnorm(x, mean = 20, sd = 6), add = TRUE, col = "darkblue", lwd = 2)

```




- Generate the empirical cumulative distribution function (eCDF) of 'Arousal' with appropriate title and label the X and Y axes.

```{r}
# Here there is another example with a better behaved data
#However, the parameters of the graph are different to what is specified in the assignment
plot(ecdf(mtcars$mpg), main = "Cumulative distribution function of mpg", xlab = "mpg", ylab = "Cumulative distribution function (eCDF)") 

```

* Based upon the eCDF, compute the proportion of observations with Arousal value less than or equal to 25.

```{r}
#We know that this distribution behaves more or less like a normal distribution, then to find the proportion of observations with a values less than or equal to 25 we can: 
#Calculate the mean of the variable we are working with
mean(mtcars$mpg)
#Calculate the Standard deviation of the variable we are working with
sd(mtcars$mpg)
# Then add all the probabilities up to 25 using the parameters we found in a normal distribution with the command dnorm
sum(dnorm(0:25, mean = 20.09062, sd = 6.026948, log = FALSE))
# Thus we know that the proportion of observations with a value less than or equal to 25 would be 81.52% based on the eCDF
```

* Based upon the eCDF, if randomly select one observation from the data, what is the probability that the Arousal value of this observation will be between 25 and 30.

```{r}
# To find such value we use a range in the dnorm distribution, again, we are assuming that the data of this variable behaves as a normal distribution with a mean = 20.09062 & sd = 6.026948
sum(dnorm(25:30, mean = 20.09062, sd = 6.026948, log = FALSE))
# Thus we got that the probability of randomly select one observation from the data with a value between 25 and 30 is 0.190053
```

* If randomly selecting a person from a population (let's say his name is John) and John's Arousal value is 5.2. Based upon the eCDF, is the population from which John was selected the same population which has this eCDF? [hint: think about the probability of Arousal <=5.2]

```{r}
# To find such value we use a range in the dnorm distribution, again, we are assuming that the data of this variable behaves as a normal distribution with a mean = 20.09062 & sd = 6.026948
sum(dnorm(0:5.2, mean = 20.09062, sd = 6.026948, log = FALSE))

```

### Question 4. [total 15 points] Write R codes in the following R code chunk for the following tasks:\  

. keep in mind that before generating the random data, using function set.seed() so that your results can be replicated.\  

. using function rnorm(), sample 100 weight values from a population of toddler whose weight following a normal distribution with mean 25 pounds and standard deviation (sd) 6 pounds, store these values in the object named 'my.wt1'

```{r}
#This is an example, you should change the parameters to solve the assignment
#First we set the seed
set.seed(123)
#We use the rnorm(n,mean,sd) function to store a sample of 1000 observations in the variable called my.wt1
my.wt1 <- rnorm(1000, mean = 50, 10)
my.wt1[1:20]

```

. using function rnorm(), sample 80 weight values from a population of 3rd grader whose weight following a normal distribution with mean 60 pounds and standard deviation (sd) 10 pounds, store these values in the object named 'my.wt2'

```{r}
#First we set the seed
set.seed(123)
#We use the rnorm(n,mean,sd) function to store a sample of 1000 observations in the variable called my.wt1
my.wt2 <- rnorm(800, mean = 100, 20)
my.wt2[1:20]


```

* using function c() to combine the data in 'my.wt1' and 'my.wt2' and store the combined data in the object named 'my.distribution', this distribution is an example of mixture distribution.

```{r}
#We can use the = sign instead of <-
my.distribution = c(my.wt1, my.wt2)
#With the head and tail functions we can check the first and last observations of the mixture distribution we just created, as we did not sort the distribution, the first values correspond to my.wt1, and the last values to my.wt2
head(my.distribution)
tail(my.distribution)

```

* generate the following output which shows the sample size, mean, standard deviation, and range of the values in the three objects: 'my.wt1', 'my.wt2', 'my.distribution'. 

```{r}
#We can create a function of generating this output
#Type function? in the console to get help if you need it 
output <- function(df){
  cat(paste('sample size = ', as.character(length(df)), '\n'))
  cat(paste('mean = ', as.character(mean(df)), '\n'))
  cat(paste('range = ', as.character(range(df)), '\n'))
}

output(my.wt1)
output(my.wt2)
output(my.distribution)
# Don't forget that the standard deviation is not included in this example
```


Verify that the mean of 'my.distribution' is the weighted average of the means of 'my.wt1' and 'my.wt2'.

```{r}
mean_mydist <- (mean(my.wt1)*(length(my.wt1)/length(my.distribution))) + (mean(my.wt2)*(length(my.wt2)/length(my.distribution)))
mean_mydist
# Compare this result with the generate by the function output()

```

* show the histogram of the weights in 'my.distribution', with normal curve and density curve over the histogram. Which curve, the normal or the density fits the data in 'my.distribution' better?

- Notice that the distribution has two peaks (bi-modal distribution). In this case, we know that the bi-modal distribution is due to the fact that the data came from two different populations.

```{r}
#First we plotted the histogram
hist(my.distribution, freq=F, breaks=12, main = "Histogram of My.distribution", xlab = "Values", ylab = "Density")
# Here we add the line for the density distribution
lines(density(my.distribution), col="red")
lines(seq(10, 200, by=5), dnorm(seq(10, 200, by=5),
      mean(my.distribution), sd(my.distribution)), col="blue")
#Add a lengend to identify the lines
legend(120,0.017, c("Density","Normal"), col = c("red","blue"), lty=1)
#As observed in the plot, the density fits better the data

```

. on the way to school, I met Johnny, a kid in our neighborhood, Johnny weighs 42.5 pounds. 
Show/mark this weight in the histogram. Given the two populations above (the population of toddler and the population of 3rd grader), which population do you think Johnny belongs to?

```{r}
#First we plotted the histogram
hist(my.distribution, freq=F, breaks=12, main = "Histogram of My.distribution", xlab = "Values", ylab = "Density")
# Here we add the line for the density distribution
lines(density(my.distribution), col="red")
lines(seq(10, 200, by=5), dnorm(seq(10, 200, by=5),
      mean(my.distribution), sd(my.distribution)), col="blue")
#Add a lengend to identify the lines
legend(120,0.017, c("Density","Normal", "Johnny's weight"), col = c("red","blue","blue"), lty=c(1,1,2), lwd = c(1,1,2))
abline(v=100, col = "blue", lty = 2, lwd = 2)
#As observed in the plot, it is easy to identify the population to which Johnny belongs... remember this is an example and not the exact answer

```

 Why you think so? Generate statistic(s) to support your answer.
 
```{r}
#We can generate statistics to compare the probability of Johnny's weight to the two populations we have
# Remember the statistics we already generated
output(my.wt1)
#Then, let's see the probability that Johnny's weight belongs to the first population. Remember to estimate the sd
dnorm(100, mean = 50.16, sd = 9.92, log = FALSE)
# You can do the same with the second population

```

* given the distribution of weights in 'my.distribution', if we randomly pick one child from this distribution, what is the probability that s/he weighs 42.5 pounds or heavier?

```{r}
#This is an example, remember to change the parameters to get the answer to the question
# we sum all the probabilities of one child from this distribution weighs between 100 and 130 pounds
sum(dnorm(100:130, mean = 72.41, sd =  29.06, log = FALSE))

```


### Question 5. [total 10 points] Write R codes in the R code chunk below to do the following:

* In a standard reading test, there are totally 50 multiple choice questions. Each question is given four possible choices with only one correct answer.
- If purely by guessing, what is the probability that one would guess the answers of at least 25 questions correctly?

```{r}
# If you need it, please review your course's notes for the binomial distribution
# First we know that the probability of having one answer in a question is 1/4, that we have 50 questions in total, and that we want to know the probability of guessing at least 15 questions correctly out of the 50 we have
sum(dbinom(15:50, size = 50, prob = 1/4))
# We add the probability of guessing correctly at least 15 questions correctly, it is to say the probability of guessing 15 questions correctly + the probability of guessing 16 questions correctly + the probability of guessing 17 questions correctly, and so forth.

```

- By purely guessing, Johnny got 4 questions correct. Is it possible? Explain why or why not.

```{r}
# Remember the difference between possibility and probability
# The first one is determined by the universe to which the event belongs, so if 6 questions are contained in the universe of the questions we have, having 6 is possible...
# However we can estimate the probability of guessing exactly 6 questions out of 50...
dbinom(6, size = 50, prob = 1/4)

```

- Jane wants to apply for a private school. She knows that that school only accepts students whose score in this standard reading test is at the top 5% of the distribution. To achieve her goal, what is the minimum number of questions Jane has to answer correctly?

```{r}
# We assume that all students are guessing to answer the questions in the reading test, to know what is the probability of answering correctly for the students that actually apply to that school, we would need the results on the test.
qbinom(0.99, 50, 1/4)
# We know she wants to be on the 99 percentile at least (1-1% at the top of the distribution), that she has to answer 50 questions by guessing with a probability of 1/4 of guessing correctly. Thus, she needs to answer 20 questions correctly to reach her goal

#This an example of how to solve the question, but you need to change the parameters

```

### Question 6. 

[total 1 point] Collect all your R codes and save it in a R script file named: Psy148a_hw05_yourInitials.R (with extension .R).

**Save a new R script file** to answer this question. You need to create an R script by clicking File --> New File --> R Script, then name it and save it.\  

**Delete any R markdown R chunks markers, to open the chunk "```{r}" and to close it**\  

**Use $#$ for any comments in your R script**\  

. To check whether any errors/warnings in your R script file, in R Console, enter the following code, source('~/Desktop/Psy148a_F2017/Psy148a_hw05_yourInitials.R', echo=TRUE)

. make sure to update/change the folder/path of your R script file to your local path.

. If your R script works, it should give you all the codes and output in R Console:


### Question 7. 
Click the Knit button and click Knit to HTLM

## Thak you!!!, good job!
